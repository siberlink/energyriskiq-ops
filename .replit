modules = ["python-3.11", "postgresql-16"]
[agent]
expertMode = true
integrations = ["python_openai_ai_integrations:1.0.0", "stripe:2.0.0"]

[nix]
channel = "stable-25_05"
packages = ["cargo", "libiconv", "rustc"]

[workflows]
runButton = "Project"

[[workflows.workflow]]
name = "Project"
mode = "parallel"
author = "agent"

[[workflows.workflow.tasks]]
task = "workflow.run"
args = "API Server"

[[workflows.workflow]]
name = "API Server"
author = "agent"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "python src/main.py --mode api"
waitForPort = 5000

[workflows.workflow.metadata]
outputType = "webview"

[[ports]]
localPort = 5000
externalPort = 80

[deployment]
deploymentTarget = "autoscale"
run = ["python", "src/main.py", "--mode", "api"]

[userenv]

[userenv.shared]
INTERNAL_RUNNER_TOKEN = "energyriskiq-runner-2026"
AI_MAX_EVENTS_PER_RUN = "10"
EMAIL_PROVIDER = "brevo"
EMAIL_FROM = "EnergyRiskIQ<alerts@energyriskiq.com>"
APP_URL = "https://energyriskiq.com"
ENABLE_GERI = "true"
ENABLE_EERI = "true"
EGSI_S_DATA_SOURCE = "composite"
ENABLE_EGSI = "true"
